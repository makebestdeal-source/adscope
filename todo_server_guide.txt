============================================================
 AdScope 서버 인프라 계획 (2026-02-28 작성, 정정본)
============================================================

[ 아키텍처 ]

  사용자 → Cloudflare CDN (무료, 캐싱)
              ↓
         Cloudflare R2 (이미지 저장, 이그레스 $0)
              ↓
         백엔드 서버 (API + DB + 스케줄러)

============================================================
 ★ 중요 정정사항
============================================================
- GCP e2-micro Always Free는 미국 3개 리전(Oregon/Iowa/South Carolina)만 해당
- 아시아(오사카/도쿄 등)에 만들면 무료 아님 (월 $7~8 과금)
- 출처: https://cloud.google.com/free/docs/free-cloud-features

============================================================
 선택지 비교
============================================================

[선택A] GCP 미국 무료 — $0/월, 느림
  - 리전: us-west1 (Oregon)
  - 스펙: 0.25 vCPU / 1GB RAM / 30GB
  - 한국 핑: 120~150ms (체감 느림)
  - 이그레스: 월 1GB (초과시 $0.12/GB)
  - 장점: 무료
  - 단점: 느림, 이그레스 1GB 초과시 과금, 고객 붙으면 이전 필요

[선택B] Contabo 일본 — EUR 4.50/월 (~6,000원), 빠름 ★추천
  - 리전: 도쿄
  - 스펙: 4 vCPU / 8GB RAM / 75GB NVMe
  - 한국 핑: ~30ms
  - 트래픽: 무제한 (이그레스 과금 없음)
  - 장점: 빠름, 스펙 좋음, 무제한 트래픽, 서버 이전 불필요
  - 단점: 월 6,000원 비용

→ 추천: [선택B] Contabo 일본
  이유: 월 6,000원으로 시작해서 고객 1,000개사까지 이전 없이 확장 가능

------------------------------------------------------------
1단계: 초기 (0~6개월, 고객 10개사 이하) — 월 ~6,000원
------------------------------------------------------------
[서버]  Contabo Cloud VPS 10 (일본 도쿄)
        - 4 vCPU / 8GB RAM / 75GB NVMe
        - 200 Mbit/s / 무제한 트래픽
        - 월 EUR 4.50 (~6,000원)
        - OS: Ubuntu 22.04 LTS

[이미지] Cloudflare R2 Free Tier
        - 10GB 무료 저장
        - 이그레스(다운로드) 무제한 $0
        - Class A 100만회/월, Class B 1000만회/월

[CDN]   Cloudflare Free Plan
        - 트래픽 무제한
        - 정적파일(이미지/JS/CSS) 글로벌 캐싱
        - DDoS 방어 포함

[도메인] Cloudflare Tunnel (무료) — 도메인 없어도 접속 가능
        또는 자체 도메인 연결

[크롤링] 로컬 PC에서 실행 → DB 동기화 (rsync/scp)
        서버에서 크롤링 X (IP 한국이어야 함)

[셋업 순서]
  1. Contabo 가입 (https://contabo.com/en/vps-server/)
     - Cloud VPS 10 선택
     - Region: Japan 선택
     - OS: Ubuntu 22.04
     - 결제 (EUR 4.50/월, 카드/페이팔)
     - 프로비저닝 대기 (~3시간, 이메일로 접속정보 발송)
  2. SSH 접속 → Python 3.11 + uvicorn + 프론트 빌드 배포
  3. Cloudflare 계정 생성 (https://dash.cloudflare.com/sign-up)
  4. R2 버킷 생성 → 이미지 업로드 파이프라인 연결
  5. Cloudflare CDN/Tunnel 설정

------------------------------------------------------------
2단계: 중기 (6개월~2년, 고객 100개사) — 월 ~7,000원
------------------------------------------------------------
[서버]  Contabo Cloud VPS 10 그대로 유지
        - 4 vCPU / 8GB RAM이면 100개사 충분

[이미지] Cloudflare R2
        - 50GB 예상 → 약 $0.60/월 (~800원)
        - 이그레스 여전히 $0

[CDN]   Cloudflare Free (동일)

[DB]    SQLite → 동시 쓰기 많아지면 PostgreSQL 전환

------------------------------------------------------------
3단계: 장기 (2년+, 고객 1,000개사) — 월 ~30,000원
------------------------------------------------------------
[서버]  Contabo Cloud VPS 30 업그레이드
        - 8 vCPU / 32GB RAM
        - 월 ~EUR 15 (~20,000원)

[이미지] Cloudflare R2
        - 500GB 예상 → 약 $7.50/월 (~10,000원)
        - 이그레스 $0 (90TB/월이어도 $0)

[DB]    PostgreSQL (서버 내 설치)
        - 동시 접속 1,000+ 대응

[추가 고려]
  - 서버 이중화 (로드밸런서)
  - DB 백업 자동화 (R2에 일일 덤프)
  - 모니터링 (Uptime Robot 무료)

============================================================
 비용 폭탄 방지 체크리스트
============================================================
[x] 이미지는 반드시 Cloudflare R2 (이그레스 $0)
[x] Contabo 무제한 트래픽 (API 이그레스 과금 없음)
[x] Cloudflare CDN으로 정적파일 캐싱 (중복 다운로드 흡수)
[x] 크롤링은 서버가 아닌 로컬에서 실행
[x] R2 무료 10GB 초과시에도 저장비만 $0.015/GB (이그레스는 $0)

============================================================
 비용 요약 (원화)
============================================================
  초기 (10개사):  월 ~6,000원  (Contabo EUR 4.50)
  중기 (100개사): 월 ~7,000원  (Contabo + R2 저장비)
  장기 (1000개사): 월 ~30,000원 (Contabo 업그레이드 + R2)

============================================================
 참고 링크 (검증됨)
============================================================
- GCP Free Tier (미국만): https://cloud.google.com/free/docs/free-cloud-features
- Cloudflare R2 가격: https://developers.cloudflare.com/r2/pricing/
- Contabo Japan VPS: https://contabo.com/en-us/locations/asia-japan/
- Contabo VPS 플랜: https://contabo.com/en/vps-server/
- R2 이미지 CDN 구축: https://transloadit.com/devtips/creating-a-free-image-cdn-with-cloudflare-r2/
- R2 vs S3 비교: https://www.pump.co/blog/cloudflare-vs-s3
